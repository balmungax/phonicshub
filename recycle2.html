<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save the Earth - Recycling for Kids</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f9ff;
        }
        h1, h2, h3, .fun-font {
            font-family: 'Fredoka', sans-serif;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .draggable-item {
            cursor: grab;
            transition: all 0.2s;
        }
        .draggable-item:active {
            cursor: grabbing;
            transform: scale(1.05);
        }
        .drop-zone {
            transition: all 0.3s;
        }
        .drop-zone.drag-over {
            transform: scale(1.05);
            border-color: #4ade80;
            background-color: #dcfce7;
        }
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .pop-in {
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }
        /* Match Game Styles */
        .match-card {
            transition: all 0.3s ease;
        }
        .match-card.selected {
            ring: 4px solid #3b82f6;
            transform: scale(1.05);
        }
        .match-card.matched {
            opacity: 0.5;
            pointer-events: none;
            background-color: #dcfce7;
            border-color: #22c55e;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #888; 
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }
    </style>
<base target="_blank">
</head>
<body class="text-slate-800">

    <!-- Navigation -->
    <nav class="bg-green-500 text-white p-4 sticky top-0 z-50 shadow-lg">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2 text-2xl font-bold fun-font cursor-pointer" onclick="showSection('home')">
                <span>üåç</span> Earth Heroes
            </div>
            <div class="flex gap-2 md:gap-4 overflow-x-auto">
                <button onclick="showSection('story')" class="px-3 py-2 rounded-full hover:bg-green-600 transition font-bold text-sm md:text-base">üìñ Story</button>
                <button onclick="showSection('words')" class="px-3 py-2 rounded-full hover:bg-green-600 transition font-bold text-sm md:text-base">üìù Words</button>
                <button onclick="showSection('match')" class="px-3 py-2 rounded-full bg-purple-500 hover:bg-purple-400 transition font-bold text-sm md:text-base shadow-md">üß© Match</button>
                <button onclick="showSection('game')" class="px-3 py-2 rounded-full bg-yellow-400 text-yellow-900 hover:bg-yellow-300 transition font-bold text-sm md:text-base shadow-md">üéÆ Sort</button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="max-w-6xl mx-auto p-4 min-h-screen">

        <!-- HOME SECTION -->
        <section id="home" class="section-view flex flex-col items-center justify-center min-h-[80vh] text-center">
            <div class="pop-in">
                <h1 class="text-5xl md:text-8xl font-bold text-green-600 mb-6 drop-shadow-sm">Save Our Planet!</h1>
                <p class="text-xl md:text-3xl text-slate-600 mb-8 max-w-2xl mx-auto">
                    Hello, little hero! üåü<br>Learn how to help the Earth, learn new words, and play fun games!
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-lg mx-auto">
                    <button onclick="showSection('story')" class="bg-blue-500 text-white text-lg px-6 py-4 rounded-2xl shadow-lg hover:bg-blue-600 transform hover:scale-105 transition flex items-center justify-center gap-2">
                        <span>üìñ</span> Read Story
                    </button>
                    <button onclick="showSection('match')" class="bg-purple-500 text-white text-lg px-6 py-4 rounded-2xl shadow-lg hover:bg-purple-600 transform hover:scale-105 transition flex items-center justify-center gap-2">
                        <span>üß©</span> Match Game
                    </button>
                    <button onclick="showSection('game')" class="bg-yellow-400 text-yellow-900 text-lg px-6 py-4 rounded-2xl shadow-lg hover:bg-yellow-300 transform hover:scale-105 transition flex items-center justify-center gap-2 md:col-span-2">
                        <span>üéÆ</span> Sorting Game
                    </button>
                </div>
            </div>
            <div class="mt-12 flex gap-8 text-6xl animate-bounce">
                <span>‚ôªÔ∏è</span><span>üå≥</span><span>üåä</span>
            </div>
        </section>

        <!-- STORY SECTION -->
        <section id="story" class="section-view hidden py-8">
            <h2 class="text-4xl font-bold text-center text-blue-600 mb-8 fun-font">The Story of Plastic</h2>
            
            <div class="grid gap-8 max-w-4xl mx-auto">
                <!-- Fact 1 -->
                <div class="bg-white p-6 rounded-3xl shadow-md flex flex-col md:flex-row items-center gap-6 card-hover">
                    <div class="text-6xl bg-blue-100 p-6 rounded-full">üåç</div>
                    <div>
                        <h3 class="text-2xl font-bold text-blue-800 mb-2">Fact 1: Plastic is Everywhere</h3>
                        <p class="text-lg text-slate-600">Since the 1950s, humans have made <strong>8.3 billion tons</strong> of plastic. That is very heavy! Most of it is used only once and then thrown away.</p>
                    </div>
                </div>

                <!-- Fact 2 -->
                <div class="bg-white p-6 rounded-3xl shadow-md flex flex-col md:flex-row-reverse items-center gap-6 card-hover">
                    <div class="text-6xl bg-red-100 p-6 rounded-full">‚è≥</div>
                    <div>
                        <h3 class="text-2xl font-bold text-red-800 mb-2">Fact 2: Plastic Lives Long</h3>
                        <p class="text-lg text-slate-600">Plastic takes <strong>400 years</strong> to go away. If a T-Rex used a plastic cup, it would still be here today!</p>
                    </div>
                </div>

                <!-- Fact 3 -->
                <div class="bg-white p-6 rounded-3xl shadow-md flex flex-col md:flex-row items-center gap-6 card-hover">
                    <div class="text-6xl bg-green-100 p-6 rounded-full">üåä</div>
                    <div>
                        <h3 class="text-2xl font-bold text-green-800 mb-2">Fact 3: The Ocean is Sick</h3>
                        <p class="text-lg text-slate-600">Every year, <strong>8 million tons</strong> of plastic go into the ocean. This hurts fish, turtles, and birds. They might eat the plastic by mistake.</p>
                    </div>
                </div>

                <!-- Fact 4 -->
                <div class="bg-white p-6 rounded-3xl shadow-md flex flex-col md:flex-row-reverse items-center gap-6 card-hover">
                    <div class="text-6xl bg-yellow-100 p-6 rounded-full">‚ôªÔ∏è</div>
                    <div>
                        <h3 class="text-2xl font-bold text-yellow-800 mb-2">Fact 4: We Can Fix It!</h3>
                        <p class="text-lg text-slate-600">Only 9% of plastic is recycled. We need to <strong>Reduce, Reuse, and Recycle</strong> more to keep our Earth clean and happy!</p>
                    </div>
                </div>
            </div>

            <div class="text-center mt-12">
                <button onclick="showSection('words')" class="bg-green-500 text-white text-xl px-8 py-3 rounded-full shadow-lg hover:bg-green-600 transition">
                    Learn the Words Next! üìù
                </button>
            </div>
        </section>

        <!-- WORDS SECTION -->
        <section id="words" class="section-view hidden py-8">
            <h2 class="text-4xl font-bold text-center text-purple-600 mb-4 fun-font">Recycling Vocabulary</h2>
            <p class="text-center text-slate-500 mb-8">Click a card to hear the word and definition!</p>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6" id="vocab-grid">
                <!-- Cards injected via JS -->
            </div>
        </section>

        <!-- MATCH GAME SECTION -->
        <section id="match" class="section-view hidden py-4">
            <div class="max-w-4xl mx-auto">
                <div class="flex justify-between items-center mb-6 bg-white p-4 rounded-2xl shadow-sm">
                    <div>
                        <h2 class="text-3xl font-bold text-purple-600 fun-font">Match Game</h2>
                        <p class="text-slate-500">Click a word, then click the correct meaning!</p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-slate-400 uppercase font-bold tracking-wider">Matches</div>
                        <div class="text-4xl font-bold text-purple-600"><span id="match-score">0</span>/<span id="match-total">0</span></div>
                    </div>
                </div>

                <div class="bg-white rounded-3xl shadow-xl p-6 md:p-10 min-h-[400px] flex flex-col justify-center">
                    <div id="match-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Left Column: Words -->
                        <div id="match-words" class="flex flex-col gap-4">
                            <!-- Words injected here -->
                        </div>
                        <!-- Right Column: Definitions -->
                        <div id="match-defs" class="flex flex-col gap-4">
                            <!-- Definitions injected here -->
                        </div>
                    </div>
                    
                    <!-- Game Over Message -->
                    <div id="match-message" class="hidden text-center py-10">
                        <div class="text-6xl mb-4">üèÜ</div>
                        <h3 class="text-3xl font-bold text-purple-600 mb-2">Amazing!</h3>
                        <p class="text-xl text-slate-600 mb-6">You matched all the words!</p>
                        <button onclick="initMatchGame()" class="bg-purple-500 text-white px-8 py-3 rounded-full font-bold hover:bg-purple-600 transition shadow-lg">Play Again</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- SORTING GAME SECTION -->
        <section id="game" class="section-view hidden py-4">
            <div class="flex flex-col items-center">
                <div class="flex justify-between items-center w-full max-w-4xl mb-6 bg-white p-4 rounded-2xl shadow-sm">
                    <div>
                        <h2 class="text-3xl font-bold text-indigo-600 fun-font">Sorting Game</h2>
                        <p class="text-slate-500">Drag the item to the correct bin!</p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-slate-400 uppercase font-bold tracking-wider">Score</div>
                        <div class="text-4xl font-bold text-indigo-600" id="score-display">0</div>
                    </div>
                </div>

                <!-- Game Area -->
                <div class="w-full max-w-4xl bg-white rounded-3xl shadow-xl p-6 min-h-[500px] flex flex-col">
                    
                    <!-- Bins -->
                    <div class="grid grid-cols-3 gap-4 mb-8">
                        <!-- Recycle Bin -->
                        <div class="drop-zone bg-blue-50 border-4 border-blue-400 rounded-2xl p-4 flex flex-col items-center justify-center h-48 relative" data-type="recycle">
                            <div class="text-5xl mb-2">‚ôªÔ∏è</div>
                            <h3 class="text-xl font-bold text-blue-700">Recycle</h3>
                            <p class="text-xs text-center text-blue-500">Paper, Plastic, Metal</p>
                        </div>

                        <!-- Trash Bin -->
                        <div class="drop-zone bg-gray-100 border-4 border-gray-400 rounded-2xl p-4 flex flex-col items-center justify-center h-48 relative" data-type="trash">
                            <div class="text-5xl mb-2">üóëÔ∏è</div>
                            <h3 class="text-xl font-bold text-gray-700">Trash</h3>
                            <p class="text-xs text-center text-gray-500">Dirty things</p>
                        </div>

                        <!-- Compost Bin -->
                        <div class="drop-zone bg-green-50 border-4 border-green-500 rounded-2xl p-4 flex flex-col items-center justify-center h-48 relative" data-type="compost">
                            <div class="text-5xl mb-2">üçé</div>
                            <h3 class="text-xl font-bold text-green-700">Compost</h3>
                            <p class="text-xs text-center text-green-500">Food, Plants</p>
                        </div>
                    </div>

                    <!-- Items Conveyor -->
                    <div class="bg-slate-50 rounded-2xl p-6 border-2 border-dashed border-slate-300 flex-grow flex items-center justify-center relative overflow-hidden">
                        <div id="items-container" class="flex flex-wrap justify-center gap-4 w-full">
                            <!-- Draggable items injected here -->
                        </div>
                        <div id="game-message" class="absolute inset-0 flex items-center justify-center bg-white/90 z-10 hidden">
                            <div class="text-center">
                                <div class="text-6xl mb-4">üéâ</div>
                                <h3 class="text-3xl font-bold text-green-600 mb-2">Great Job!</h3>
                                <p class="text-xl text-slate-600 mb-6">You cleaned up the Earth!</p>
                                <button onclick="initSortGame()" class="bg-green-500 text-white px-6 py-3 rounded-full font-bold hover:bg-green-600 transition">Play Again</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- DATA (UPDATED DEFINITIONS) ---
        const vocabList = [
            { word: "Recycle", def: "To clean old things and make them into something new.", icon: "‚ôªÔ∏è" },
            { word: "Reuse", def: "To use something again instead of throwing it away.", icon: "üîÑ" },
            { word: "Reduce", def: "To use less of something to make less trash.", icon: "‚¨áÔ∏è" },
            { word: "Waste", def: "Things that people throw away.", icon: "üóëÔ∏è" },
            { word: "Trash", def: "Things that are dirty and cannot be used again.", icon: "üöØ" },
            { word: "Bin", def: "A big box where we put trash or recycling.", icon: "üóëÔ∏è" },
            { word: "Sort", def: "To put things into groups, like paper with paper.", icon: "üóÇÔ∏è" },
            { word: "Clean", def: "Not dirty. It looks nice.", icon: "‚ú®" },
            { word: "Dirty", def: "Not clean. It has mud or germs on it.", icon: "ü¶†" },
            { word: "Plastic", def: "A light material used to make bottles and bags.", icon: "ü•§" },
            { word: "Paper", def: "A thin material made from trees. We write on it.", icon: "üìÑ" },
            { word: "Metal", def: "A hard, shiny material used to make cans.", icon: "ü•´" },
            { word: "Transparent", def: "You can see through it, like a window.", icon: "üîç" },
            { word: "Earth", def: "The planet where we live. Our home.", icon: "üåç" },
            { word: "Ocean", def: "A very big area of water with fish and whales.", icon: "üåä" },
            { word: "River", def: "Water that moves from the mountains to the sea.", icon: "üèûÔ∏è" },
            { word: "Contamination", def: "When dirt or poison makes water or land bad.", icon: "‚ò†Ô∏è" },
            { word: "Animal", def: "A living thing like a fish, bird, or dog.", icon: "üê¢" },
            { word: "Help", def: "To do something good for someone else.", icon: "ü§ù" },
            { word: "Save", def: "To keep something safe.", icon: "üíæ" },
            { word: "Protect", def: "To keep something safe from danger.", icon: "üõ°Ô∏è" }
        ];

        const sortItems = [
            { id: 1, name: "Banana Peel", type: "compost", icon: "üçå" },
            { id: 2, name: "Plastic Bottle", type: "recycle", icon: "ü•§" },
            { id: 3, name: "Newspaper", type: "recycle", icon: "üì∞" },
            { id: 4, name: "Apple Core", type: "compost", icon: "üçé" },
            { id: 5, name: "Candy Wrapper", type: "trash", icon: "üç¨" },
            { id: 6, name: "Soda Can", type: "recycle", icon: "ü•´" },
            { id: 7, name: "Broken Toy", type: "trash", icon: "üß∏" },
            { id: 8, name: "Egg Shell", type: "compost", icon: "ü•ö" },
            { id: 9, name: "Cardboard Box", type: "recycle", icon: "üì¶" },
            { id: 10, name: "Styrofoam Cup", type: "trash", icon: "‚òï" },
            { id: 11, name: "Glass Jar", type: "recycle", icon: "üçØ" },
            { id: 12, name: "Fish Bones", type: "compost", icon: "üêü" }
        ];

        // --- STATE ---
        let sortScore = 0;
        let currentSortItems = [];
        
        let matchScore = 0;
        let matchTotal = 0;
        let selectedCard = null; // For match game
        let remainingMatches = []; // Pool of words for match game

        // --- NAVIGATION ---
        function showSection(sectionId) {
            document.querySelectorAll('.section-view').forEach(el => el.classList.add('hidden'));
            const target = document.getElementById(sectionId);
            target.classList.remove('hidden');
            target.classList.add('pop-in');
            
            if (sectionId === 'words') renderVocab();
            if (sectionId === 'game') initSortGame();
            if (sectionId === 'match') initMatchGame();
            
            window.scrollTo(0, 0);
        }

        // --- VOCABULARY LOGIC ---
        function renderVocab() {
            const container = document.getElementById('vocab-grid');
            container.innerHTML = '';
            vocabList.forEach(item => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition cursor-pointer border-b-4 border-purple-200 flex flex-col items-center text-center h-full';
                card.onclick = () => speak(item.word + ". " + item.def);
                card.innerHTML = `
                    <div class="text-5xl mb-4">${item.icon}</div>
                    <h3 class="text-xl font-bold text-purple-700 mb-2">${item.word}</h3>
                    <p class="text-sm text-slate-500">${item.def}</p>
                    <div class="mt-auto pt-4 text-purple-300 text-xs font-bold uppercase tracking-wide">Click to Listen</div>
                `;
                container.appendChild(card);
            });
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                window.speechSynthesis.speak(utterance);
            }
        }

        // --- MATCH GAME LOGIC ---
        function initMatchGame() {
            matchScore = 0;
            document.getElementById('match-score').innerText = "0";
            document.getElementById('match-total').innerText = vocabList.length;
            document.getElementById('match-message').classList.add('hidden');
            document.getElementById('match-container').classList.remove('hidden');
            
            // Reset pool
            remainingMatches = [...vocabList];
            selectedCard = null;
            
            renderMatchRound();
        }

        function renderMatchRound() {
            const wordsContainer = document.getElementById('match-words');
            const defsContainer = document.getElementById('match-defs');
            wordsContainer.innerHTML = '';
            defsContainer.innerHTML = '';

            if (remainingMatches.length === 0) {
                document.getElementById('match-container').classList.add('hidden');
                document.getElementById('match-message').classList.remove('hidden');
                speak("Great job! You finished the game!");
                return;
            }

            // Take 4 items (or remaining)
            const roundItems = remainingMatches.slice(0, 4);
            
            // Create Word Cards (Left)
            roundItems.forEach(item => {
                const card = document.createElement('div');
                card.className = 'match-card bg-blue-100 p-4 rounded-xl border-2 border-blue-300 cursor-pointer hover:bg-blue-200 flex items-center gap-3';
                card.dataset.word = item.word;
                card.dataset.type = 'word';
                card.innerHTML = `<span class="text-2xl">${item.icon}</span> <span class="font-bold text-blue-800 text-lg">${item.word}</span>`;
                card.onclick = () => handleMatchClick(card, item);
                wordsContainer.appendChild(card);
            });

            // Create Def Cards (Right) - Shuffled
            const shuffledDefs = [...roundItems].sort(() => Math.random() - 0.5);
            shuffledDefs.forEach(item => {
                const card = document.createElement('div');
                card.className = 'match-card bg-green-50 p-4 rounded-xl border-2 border-green-300 cursor-pointer hover:bg-green-100 flex items-center';
                card.dataset.word = item.word;
                card.dataset.type = 'def';
                card.innerHTML = `<span class="text-sm md:text-base text-green-900">${item.def}</span>`;
                card.onclick = () => handleMatchClick(card, item);
                defsContainer.appendChild(card);
            });
        }

        function handleMatchClick(card, item) {
            if (card.classList.contains('matched')) return;

            // If nothing selected yet
            if (!selectedCard) {
                selectedCard = card;
                card.classList.add('selected');
                speak(item.word); // Speak the word
                return;
            }

            // If clicking same card, deselect
            if (selectedCard === card) {
                card.classList.remove('selected');
                selectedCard = null;
                return;
            }

            // If clicking another card
            const prevCard = selectedCard;
            const currentCard = card;

            // Check match
            if (prevCard.dataset.word === currentCard.dataset.word) {
                // Match!
                prevCard.classList.remove('selected');
                prevCard.classList.add('matched');
                currentCard.classList.add('matched');
                
                // Visual success
                prevCard.style.backgroundColor = "#dcfce7";
                currentCard.style.backgroundColor = "#dcfce7";
                
                matchScore++;
                document.getElementById('match-score').innerText = matchScore;
                speak("Correct!");
                
                // Remove from remaining pool
                remainingMatches = remainingMatches.filter(i => i.word !== item.word);
                
                selectedCard = null;

                // Delay then next round
                setTimeout(renderMatchRound, 1000);
            } else {
                // No Match
                currentCard.classList.add('shake');
                prevCard.classList.add('shake');
                speak("Try again");
                
                setTimeout(() => {
                    currentCard.classList.remove('shake');
                    prevCard.classList.remove('shake');
                    prevCard.classList.remove('selected');
                    selectedCard = null;
                }, 500);
            }
        }

        // --- SORTING GAME LOGIC (RENAMED FUNCTIONS TO AVOID CONFLICT) ---
        function initSortGame() {
            sortScore = 0;
            document.getElementById('score-display').innerText = sortScore;
            document.getElementById('game-message').classList.add('hidden');
            currentSortItems = [...sortItems].sort(() => Math.random() - 0.5);
            renderSortItems();
        }

        function renderSortItems() {
            const container = document.getElementById('items-container');
            container.innerHTML = '';
            if (currentSortItems.length === 0) {
                document.getElementById('game-message').classList.remove('hidden');
                return;
            }
            currentSortItems.forEach(item => {
                const el = document.createElement('div');
                el.className = 'draggable-item bg-white p-4 rounded-xl shadow-lg border-2 border-slate-200 flex flex-col items-center w-24 select-none';
                el.draggable = true;
                el.dataset.id = item.id;
                el.dataset.type = item.type;
                el.innerHTML = `
                    <div class="text-4xl mb-1 pointer-events-none">${item.icon}</div>
                    <div class="text-xs font-bold text-slate-600 text-center pointer-events-none">${item.name}</div>
                `;
                el.addEventListener('dragstart', handleSortDragStart);
                el.addEventListener('dragend', handleSortDragEnd);
                el.addEventListener('touchstart', handleSortTouchStart, {passive: false});
                el.addEventListener('touchmove', handleSortTouchMove, {passive: false});
                el.addEventListener('touchend', handleSortTouchEnd);
                container.appendChild(el);
            });
        }

        let draggedSortItem = null;
        let touchSortItem = null;

        function handleSortDragStart(e) {
            draggedSortItem = this;
            this.style.opacity = '0.5';
        }
        function handleSortDragEnd(e) {
            this.style.opacity = '1';
            draggedSortItem = null;
            document.querySelectorAll('.drop-zone').forEach(z => z.classList.remove('drag-over'));
        }

        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
            zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
            zone.addEventListener('drop', e => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                if (draggedSortItem) checkSortMatch(draggedSortItem, zone);
            });
        });

        // Touch for Sort
        function handleSortTouchStart(e) {
            e.preventDefault();
            touchSortItem = this;
            const touch = e.touches[0];
            const rect = touchSortItem.getBoundingClientRect();
            touchSortItem.style.position = 'fixed';
            touchSortItem.style.zIndex = '1000';
            touchSortItem.style.width = rect.width + 'px';
            touchSortItem.style.opacity = '0.8';
            moveSortAt(touch.clientX, touch.clientY);
        }
        function moveSortAt(x, y) {
            if(!touchSortItem) return;
            touchSortItem.style.left = (x - touchSortItem.offsetWidth/2) + 'px';
            touchSortItem.style.top = (y - touchSortItem.offsetHeight/2) + 'px';
        }
        function handleSortTouchMove(e) {
            e.preventDefault();
            if(!touchSortItem) return;
            moveSortAt(e.touches[0].clientX, e.touches[0].clientY);
        }
        function handleSortTouchEnd(e) {
            if(!touchSortItem) return;
            touchSortItem.style.display = 'none';
            let elem = document.elementFromPoint(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
            touchSortItem.style.display = 'flex';
            touchSortItem.style.position = '';
            touchSortItem.style.zIndex = '';
            touchSortItem.style.left = '';
            touchSortItem.style.top = '';
            touchSortItem.style.opacity = '1';
            
            if (elem) {
                let zone = elem.closest('.drop-zone');
                if (zone) checkSortMatch(touchSortItem, zone);
            }
            touchSortItem = null;
        }

        function checkSortMatch(itemEl, zoneEl) {
            if (itemEl.dataset.type === zoneEl.dataset.type) {
                itemEl.classList.add('border-green-500', 'bg-green-50');
                const id = parseInt(itemEl.dataset.id);
                currentSortItems = currentSortItems.filter(i => i.id !== id);
                sortScore += 10;
                document.getElementById('score-display').innerText = sortScore;
                speak("Good job!");
                setTimeout(() => {
                    itemEl.remove();
                    if (currentSortItems.length === 0) {
                        document.getElementById('game-message').classList.remove('hidden');
                        speak("Game Over. Great Job!");
                    }
                }, 500);
            } else {
                itemEl.classList.add('shake', 'border-red-500');
                speak("Try again.");
                setTimeout(() => itemEl.classList.remove('shake', 'border-red-500'), 500);
            }
        }

        // Start
        showSection('home');
    </script>
</body>
</html>